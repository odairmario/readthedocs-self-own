{% extends "projects/project_edit_base.html" %}

{% load i18n %}

{% block title %}{% trans "Automation Rule" %}{% endblock %}

{% block nav-dashboard %} class="active"{% endblock %}

{% block project-automation-rules-active %}active{% endblock %}
{% block project_edit_content_header %}{% trans "Automation Rule" %}{% endblock %}


{% block extra_scripts %}
  <script type="text/javascript">
    function set_help_text(value) {
      var help_texts = {
        'all-versions': 'All versions will be matched.',
        'semver-versions': 'Versions incremented based on semantic versioning rules will be matched.',
        '': ''
      };
      $('#id_predefined_match_arg').siblings('.helptext').text(help_texts[value]);
    }

    $(document).ready(function() {
      var value = $('#id_predefined_match_arg').val();
      if (value !== '') {
        $('#id_match_arg').parent().hide();
      }
      set_help_text(value);

      $('#id_predefined_match_arg').bind('change', function(ev) {
        if (this.value === '') {
          $('#id_match_arg').parent().show();
        } else {
          $('#id_match_arg').parent().hide();
        }
        set_help_text(this.value);
      });
    });
  </script>
{% endblock %}

{% block project_edit_content %}
  <form
      method="post"
      class="form-wide"
      action=".">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="{% trans "Save" %}">
  </form>

  {% if object.pk %}
  <form method="post" action="{% url 'projects_automation_rule_delete' object.project.slug object.pk %}">
    {% csrf_token %}
    <input type="submit" value="{% trans "Delete" %}">
  </form>
  {% endif %}

{% endblock %}
